<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>extensions/http_api/client.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-extensions_Cli_Cli-Cli.html">Cli</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_Cli_Cli-Cli.html#getCwd">getCwd</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_Cli_Cli-Cli.html#getExitCode">getExitCode</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_Cli_Cli-Cli.html#getOutput">getOutput</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_Cli_Cli-Cli.html#reset">reset</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_Cli_Cli-Cli.html#run">run</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_Cli_Cli-Cli.html#setCwd">setCwd</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_Cli_Cli-Cli.html#setEnvironmentVariable">setEnvironmentVariable</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_Cli_Cli-Cli.html#setEnvironmentVariables">setEnvironmentVariables</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-extensions_fixtures_FixturesLoader-FixturesLoader.html">FixturesLoader</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_fixtures_FixturesLoader-FixturesLoader.html#configure">configure</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_fixtures_FixturesLoader-FixturesLoader.html#load">load</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_fixtures_FixturesLoader-FixturesLoader.html#loadJson">loadJson</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_fixtures_FixturesLoader-FixturesLoader.html#loadModule">loadModule</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_fixtures_FixturesLoader-FixturesLoader.html#loadText">loadText</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_fixtures_FixturesLoader-FixturesLoader.html#loadYaml">loadYaml</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_fixtures_FixturesLoader-FixturesLoader.html#reset">reset</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_fixtures_FixturesLoader-FixturesLoader.html#setFeatureUri">setFeatureUri</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-extensions_httpApi_client-HttpApiClient.html">HttpApiClient</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_httpApi_client-HttpApiClient.html#clearBody">clearBody</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_httpApi_client-HttpApiClient.html#clearHeaders">clearHeaders</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_httpApi_client-HttpApiClient.html#clearRequestCookies">clearRequestCookies</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_httpApi_client-HttpApiClient.html#disableCookies">disableCookies</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_httpApi_client-HttpApiClient.html#enableCookies">enableCookies</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_httpApi_client-HttpApiClient.html#getCookie">getCookie</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_httpApi_client-HttpApiClient.html#getCookies">getCookies</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_httpApi_client-HttpApiClient.html#getResponse">getResponse</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_httpApi_client-HttpApiClient.html#makeRequest">makeRequest</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_httpApi_client-HttpApiClient.html#reset">reset</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_httpApi_client-HttpApiClient.html#setCookie">setCookie</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_httpApi_client-HttpApiClient.html#setFormBody">setFormBody</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_httpApi_client-HttpApiClient.html#setHeader">setHeader</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_httpApi_client-HttpApiClient.html#setHeaders">setHeaders</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_httpApi_client-HttpApiClient.html#setJsonBody">setJsonBody</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_httpApi_client-HttpApiClient.html#setQuery">setQuery</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-extensions_snapshot_Snapshot-Snapshot.html">Snapshot</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_snapshot_Snapshot-Snapshot.html#expectToMatch">expectToMatch</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-extensions_state_State-State.html">State</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_state_State-State.html#clear">clear</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_state_State-State.html#dump">dump</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_state_State-State.html#get">get</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_state_State-State.html#set">set</a></span></li><li class="nav-heading">Modules</li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-Cast.html">Cast</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Cast.html#.addType">addType</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Cast.html#.array">array</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Cast.html#.object">object</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Cast.html#.objects">objects</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Cast.html#.value">value</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Cast.html#~CastFunction">CastFunction</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-extensions_Cli.html">extensions/Cli</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_Cli.html#.extendWorld">extendWorld</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_Cli.html#.install">install</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-extensions_Cli_Cli.html">extensions/Cli/Cli</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-extensions_FileSystem.html">extensions/FileSystem</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_FileSystem.html#.extendWorld">extendWorld</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_FileSystem.html#.install">install</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-extensions_FileSystem_FileSystem.html">extensions/FileSystem/FileSystem</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_FileSystem_FileSystem.html#.createDirectory">createDirectory</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_FileSystem_FileSystem.html#.getFileContent">getFileContent</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_FileSystem_FileSystem.html#.getFileInfo">getFileInfo</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_FileSystem_FileSystem.html#.remove">remove</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-extensions_fixtures.html">extensions/fixtures</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_fixtures.html#.extendWorld">extendWorld</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_fixtures.html#.install">install</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-extensions_fixtures_FixturesLoader.html">extensions/fixtures/FixturesLoader</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-extensions_fixtures_hooks.html">extensions/fixtures/hooks</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-extensions_httpApi.html">extensions/httpApi</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_httpApi.html#.extendWorld">extendWorld</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_httpApi.html#.install">install</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-extensions_httpApi_client.html">extensions/httpApi/client</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-extensions_snapshot.html">extensions/snapshot</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_snapshot.html#.extendWorld">extendWorld</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_snapshot.html#.install">install</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-extensions_snapshot_cleanup.html">extensions/snapshot/cleanup</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_snapshot_cleanup.html#.cleanSnapshots">cleanSnapshots</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_snapshot_cleanup.html#.referenceSnapshot">referenceSnapshot</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_snapshot_cleanup.html#.resetReferences">resetReferences</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-extensions_snapshot_cmdOptions.html">extensions/snapshot/cmdOptions</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-extensions_snapshot_dedent.html">extensions/snapshot/dedent</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_snapshot_dedent.html#~getSpacesLength">getSpacesLength</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-extensions_snapshot_FileSystem.html">extensions/snapshot/FileSystem</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_snapshot_FileSystem.html#.createDirectory">createDirectory</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_snapshot_FileSystem.html#.getFileContent">getFileContent</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_snapshot_FileSystem.html#.getFileInfo">getFileInfo</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_snapshot_FileSystem.html#.remove">remove</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_snapshot_FileSystem.html#.writeFileContent">writeFileContent</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-extensions_snapshot_Snapshot.html">extensions/snapshot/Snapshot</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-extensions_snapshot_snapshot_.html">extensions/snapshot/snapshot</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_snapshot_snapshot_.html#.diff">diff</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_snapshot_snapshot_.html#.extractScenarios">extractScenarios</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_snapshot_snapshot_.html#.formatSnapshotFile">formatSnapshotFile</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_snapshot_snapshot_.html#.normalizeNewlines">normalizeNewlines</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_snapshot_snapshot_.html#.parseSnapshotFile">parseSnapshotFile</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_snapshot_snapshot_.html#.prefixSnapshots">prefixSnapshots</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_snapshot_snapshot_.html#.readSnapshotFile">readSnapshotFile</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_snapshot_snapshot_.html#.snapshotsPath">snapshotsPath</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_snapshot_snapshot_.html#.wrapWithBacktick">wrapWithBacktick</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_snapshot_snapshot_.html#.writeSnapshotFile">writeSnapshotFile</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-extensions_snapshot_statistics.html">extensions/snapshot/statistics</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-extensions_state.html">extensions/state</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_state.html#.extendWorld">extendWorld</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-extensions_state.html#.install">install</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-extensions_state_State.html">extensions/state/State</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#countNestedProperties">countNestedProperties</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#hasExtension">hasExtension</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#mustGetResponse">mustGetResponse</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#registerExtension">registerExtension</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">extensions/http_api/client.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict'

/**
 * The http client used by the http API extension.
 *
 * @module extensions/httpApi/client
 */

const _ = require('lodash')
const request = require('request').defaults({ json: true })
const { Cookie } = require('tough-cookie')

const BODY_TYPE_JSON = 'json'
const BODY_TYPE_FORM = 'form'

/**
 * Http Api Client extension.
 *
 * @class
 */
class HttpApiClient {
    constructor() {
        // REQUEST INFORMATION
        this.body = null
        this.bodyType = null
        this.headers = null
        this.query = null
        this.cookies = []
        this.cookieJar = null

        // RESPONSE INFORMATION
        this.response = null
        this.responseCookies = {}
    }

    /**
     * Resets the client.
     */
    reset() {
        this.body = null
        this.bodyType = null
        this.headers = null
        this.query = null

        this.cookies = []
        this.cookieJar = null

        this.response = null
        this.responseCookies = {}
    }

    /**
     * Sets request json body.
     *
     * @param {Object} payload
     */
    setJsonBody(payload) {
        this.bodyType = BODY_TYPE_JSON
        this.body = payload
    }

    /**
     * Sets request form body.
     *
     * @param {Object} payload
     */
    setFormBody(payload) {
        this.bodyType = BODY_TYPE_FORM
        this.body = payload
    }

    /**
     * Clears current request body
     */
    clearBody() {
        this.body = null
        this.bodyType = null
    }

    /**
     * Sets request query parameters.
     *
     * @param {Object} query
     */
    setQuery(query) {
        this.query = query
    }

    /**
     * Sets request headers.
     *
     * @param {Object} headers
     */
    setHeaders(headers) {
        this.headers = headers
    }

    /**
     * Sets a single request header.
     *
     * @param {string} key
     * @param {string} value
     */
    setHeader(key, value) {
        this.headers = this.headers || {}
        this.headers[key] = value
    }

    /**
     * Clears current request headers.
     */
    clearHeaders() {
        this.headers = null
    }

    /**
     * Enables cookie jar.
     */
    enableCookies() {
        if (this.cookieJar !== null) return

        this.cookieJar = request.jar()
        this.cookieJar._jar.rejectPublicSuffixes = false
    }

    /**
     * Disables cookie jar.
     */
    disableCookies() {
        this.cookieJar = null
    }

    /**
     * Sets a cookie.
     * It does not actually add the cookie to the cookie jar
     * because setting the cookie requires the request url,
     * which we only have when making the request.
     *
     * @param {string|Object} cookie - Cookie string or Object
     */
    setCookie(cookie) {
        if (!_.isPlainObject(cookie) &amp;&amp; !_.isString(cookie)) {
            throw new TypeError(`"cookie" must be a string or a cookie object`)
        }

        this.enableCookies()
        this.cookies.push(cookie)
    }

    /**
     * Clears registered request cookies.
     * Be aware that it does not clear existing response cookies.
     */
    clearRequestCookies() {
        this.cookies = []
    }

    /**
     * Retrieves a cookie by its key.
     *
     * @param {string} key - Cookie key
     * @return {Object|null} The cookie object if any, or null
     */
    getCookie(key) {
        if (this.responseCookies === null) return null
        if (this.responseCookies[key] === undefined) return null

        return this.responseCookies[key]
    }

    /**
     * Returns current response cookies.
     *
     * @return {Object} current response cookies
     */
    getCookies() {
        return this.responseCookies
    }

    /**
     * Returns the latest collected response.
     */
    getResponse() {
        return this.response
    }

    /**
     * Performs a request using all previously defined paramaters:
     * - headers
     * - query
     * - body
     *
     * @param {string} method    - The http verb
     * @param {string} path      - The path
     * @param {string} [baseUrl] - The base url
     */
    makeRequest(method, path, baseUrl) {
        return new Promise((resolve, reject) => {
            const options = {
                baseUrl: baseUrl,
                uri: path,
                method,
                qs: this.query || {},
                headers: this.headers,
                jar: this.cookieJar
            }

            const fullUri = `${baseUrl}${path}`

            if (this.body !== null) {
                if (!['POST', 'PUT'].includes(method)) {
                    throw new Error(
                        `You can only provides a body for POST and PUT HTTP methods, found: ${method}`
                    )
                }

                if (this.bodyType === BODY_TYPE_JSON) {
                    options.json = true
                    options.body = this.body
                } else if (this.bodyType === BODY_TYPE_FORM) {
                    options.form = this.body
                }
            }

            if (this.cookieJar !== null) {
                this.cookies.forEach(cookie => {
                    if (_.isPlainObject(cookie)) {
                        this.cookieJar.setCookie(new Cookie(cookie), fullUri)
                    } else if (_.isString(cookie)) {
                        this.cookieJar.setCookie(cookie, fullUri)
                    }
                })
            }

            request(options, (_error, _response, _body) => {
                if (_error) {
                    console.error(_error, options) // eslint-disable-line no-console
                    reject()
                }

                this.response = _response

                if (this.cookieJar !== null) {
                    this.responseCookies = {}
                    this.cookieJar.getCookies(fullUri).forEach(cookie => {
                        this.responseCookies[cookie.key] = cookie
                    })
                }

                resolve()
            })
        })
    }
}

/**
 * Create a new isolated http api client
 * @return {HttpApiClient}
 */
module.exports = function(...args) {
    return new HttpApiClient(...args)
}

/**
 * Http api client extension.
 * @type {HttpApiClient}
 */
module.exports.HttpApiClient = HttpApiClient
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Mon Oct 09 2017 18:28:11 GMT+0200 (CEST) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
